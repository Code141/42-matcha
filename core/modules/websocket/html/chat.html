<style>
	section#chat
	{
		position: fixed;
		bottom: 0px;
		right: 0px;
	}
	div#chat_list
	{
		bottom:0px;
		float: right;
	}

	.error {
		color:#FF0000;
	}

	.chat-connection-ack
	{
		color: #26af26;
	}


	.frmChat
	{
		width: 300px;
		background-color:red;
		float: right;
	}

	#btnSend
	{
		background: #26af26;
		border: #26af26 1px solid;
		color: #FFF;
		display: block;
		padding: 10px 50px;
		cursor: pointer;
	}

	#chat-box
	{
		background: #fff8f8;
		border: 1px solid #ffdddd;
		border-bottom-left-radius:0px;
		border-bottom-right-radius: 0px;
		min-height: 30px;
		padding: 10px;
		overflow: none scroll;
		height: 300px;
	}

	.chat-box-html
	{
		color: #09F;
		margin: 10px 0px;
		font-size:0.8em;
	}

	.chat-box-message
	{
		color: #09F;
		padding: 5px 10px;
		background-color: #fff;
		border: 1px solid #ffdddd;
		border-radius:4px;
		display:inline-block;
	}

	.chat-input
	{
		border: 1px solid #ffdddd;
		border-top: 0px;
		width: 100%;
		box-sizing: border-box;
		padding: 10px 8px;
		color: #191919;
	}

</style>
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script>
function showMessage(messageHTML) {
	$('#chat-box').append(messageHTML);
}
$(document).ready(function()
{
	url = "ws://localhost:8090/toto";
	if ("WebSocket" in window)
		websocket = new WebSocket(url);
	else if ("MozWebSocket" in window)
		websocket = new MozWebSocket(url);


	websocket.onopen = function(event)
	{
		showMessage("<div class='chat-connection-ack'>Connection is established!</div>");	
		var messageJSON = {ssid: "<?php echo session_id(); ?>"};
		websocket.send(JSON.stringify(messageJSON));
	}

	window.onbeforeunload = function()
	{
		websocket.onclose = function () {}; // disable onclose handler first
		websocket.close();
	};

	websocket.onmessage = function(event)
	{
		var Data = JSON.parse(event.data);
		showMessage("<div class='"+Data.message_type+"'>"+Data.message+"</div>");
		$('#chat-message').val('');
	};

	websocket.onerror = function(event)
	{
		showMessage("<div class='error'>Problem due to some Error</div>");
		console.log(event);
	};

	websocket.onclose = function(event)
	{
		showMessage("<div class='chat-connection-ack'>Connection Closed</div>");
	}; 

	$('.frmChat').on("submit", function(event)
	{
		event.preventDefault();
		var messageJSON = {
		ssid: "<?php echo session_id(); ?>",
			chat_message: $('#chat-message').val()
		};
		websocket.send(JSON.stringify(messageJSON));
	});
});
</script>
	<?php echo session_id(); ?>
<section id="chat">
	<div id="chat_list">
	chatlist
	</div>
	<form name="frmChat" class="frmChat">
		<div id="chat-box_name">
			Fiofy
		</div>
		<div id="chat-box">
		</div>
		<input type="text" name="chat-message" id="chat-message" placeholder="Message"  class="chat-input chat-message"   autocomplete="off"/>
		<input type="submit" id="btnSend" name="send-chat-message" value="Send" >
	</form>

</section>
