<p id='response'></p>
<button id='position_button' >Get your position</button>
<div id="map"></div>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
					   integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
		crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
		integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
  crossorigin=""></script>


<script>
window.addEventListener('load',load);
window.addEventListener('load',initMap);

function load(){
	var position_button = document.getElementById('position_button');
	position_button.addEventListener('click', getLocation);
}

var p = document.getElementById('response');

function getLocation() {
	if (navigator.geolocation) {
		navigator.geolocation.getCurrentPosition(showPosition, showError);
	} else {
		p.innerHTML = "Geolocation is not supported by this browser.";
	}
}

function showPosition(position) {	
	p.innerHTML = "Latitude: " + position.coords.latitude + 
		"<br>Longitude: " + position.coords.longitude; 
}

function showError(error) {
	switch(error.code) {
		case error.PERMISSION_DENIED:
			p.innerHTML = "User denied the request for Geolocation."
				break;
		case error.POSITION_UNAVAILABLE:
			p.innerHTML = "Location information is unavailable."
				break;
		case error.TIMEOUT:
			p.innerHTML = "The request to get user location timed out."
				break;
		case error.UNKNOWN_ERROR:
			p.innerHTML = "An unknown error occurred."
				break;
	}
}


<!--      ----------- THIS IS THE MAP SCRIPT ---------- -->
var villes = {
	"Paris": { "lat": 48.852969, "lon": 2.349903 },
	"Brest": { "lat": 48.383, "lon": -4.500 },
	"Quimper": { "lat": 48.000, "lon": -4.100 },
	"Bayonne": { "lat": 43.500, "lon": -1.467 }
};

function initMap() {
	map = new L.map('map');

	for (ville in villes) {
		var marker = L.marker([villes[ville].lat, villes[ville].lon]).addTo(map);
		marker.bindPopup("<b>Hello "+ville+"!</b><br>").openPopup();
	}

	var lat = 48.852969;
	var lon = 2.349903;

	map.setView([lat, lon], 13);

	var osm = new L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
			attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a>',
			minZoom: 2,
			maxZoom: 18
			}).addTo(map);

	var control = L.control.geonames({
		//position: 'topcenter',  // in addition to standard 4 corner Leaflet control layout, this will position and size from top center
		geonamesURL: '//api.geonames.org/searchJSON',  // override this if using a proxy to get connection to geonames
			username: '',  // Geonames account username.  Must be provided
			zoomLevel: null,  // Max zoom level to zoom to for location.  If null, will use the map's max zoom level.
			maxresults: 5,  // Maximum number of results to display per search
			className: 'leaflet-geonames-icon', //class for icon
			workingClass: 'leaflet-geonames-icon-working', //class for search underway
			featureClasses: ['A', 'H', 'L', 'P', 'R', 'T', 'U', 'V'],  // feature classes to search against.  See: http://www.geonames.org/export/codes.html
			baseQuery: 'isNameRequired=true',  // The core query sent to GeoNames, later combined with other parameters above
			position: 'topleft',
			showMarker: true, //Show a marker at the location the selected location
			showPopup: true, //Show a tooltip at the selected location
			adminCodes: { // filter results by a country and state.  Values can be strings or return by a function.
				country: 'us',
				adminCode1: function() {return 'wa'}
			},
			lang: 'en', // language for results
			bbox: {east:-121, west: -123, north: 46, south: 45}, // bounding box filter for results (e.g., map extent).  Values can be an object with east, west, north, south, or a function that returns that object.
			alwaysOpen: false,  //if true, search field is always visible
			enablePostalCodes: false, // if true, use postalCodesRegex to test user provided string for a postal code.  If matches, then search against postal codes API instead.
			postalCodesRegex: POSTALCODE_REGEX_US // regex used for testing user provided string for a postal code.  If this test fails, the default geonames API is used instead.
	});
	map.addControl(control);
}
</script>
