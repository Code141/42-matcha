<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>
<?php $user = $this->module_loader->session()->controller->user_loggued(); ?>
<fieldset>
	<legend></legend>
<?php 
$user = $this->module_loader->session()->controller->user_loggued();
?>
	<p class="f_title">
		<?php echo $user['username']; ?>
	</p>
	<div id="profil_pic">
	    <img id="profil_pic" src="https://www.everymanlegal.com/wpcms/wp-content/uploads/2016/11/Geoffrey-Cotterill-2017-e1484233752609.jpg">
	</div>
	<p id="bio">
		biLorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputatepo
	</p>

</fieldset>
<fieldset>
	<legend>General informations</legend>
	<p>Position :</p>
	<div id="map"></div>
	<div id="more_info">
		<p>
		<span>Firstname</span>:
		<?php echo $user['firstname']; ?>
		</p>
		<p>
		<span>Lastname</span>:
		<?php echo $user['lastname']; ?>
		</p>
		<p>
		<span>Gender</span>:
		<?php echo $user['gender_name']; ?>
		</p>
		<p>
		<span>Gender identity</span>:
		<?php echo $user['gender_identity_name']; ?>
		</p>
		<p>
		<span>Age</span>:
		<?php echo date_diff(date_create($user['birthdate']), date_create('today'))->y . " years old"; ?>
		</p>	
		<p>
		<span>Birthdate</span>:
		<?php echo $user['birthdate']; ?>
		</p>	
		<p>
		<span>Email</span>:
		<?php echo $user['email']; ?>
		</p>
	</div>
</fieldset>
<fieldset>
	<legend>Matching preferences</legend>
	<div class="wrap">
		<div id="o_gender">
			<p class="f_title">gender</p>
		</div>
		<div id="o_gender_identity">
			<p class="f_title">gender identity</p>
		</div>
	</div>
	<hr>
	<div id="o_gender">
		<?php foreach($user['orientations'] as $value) { ?>
		<p>
		<?php echo $value['gender_name'];?>
		</p>
		<?php } ?>
	</div>
	<div id="o_gender_identity">
		<?php foreach($user['orientations'] as $value) { ?>
		<p>
		<?php echo $value['gender_identity_name']; ?>
		</p>
		<?php } ?>
	</div>
</fieldset>
<fieldset id="pictures">
	<legend>pictures</legend>
</fieldset>
<fieldset id="tag">
	<legend>tags</legend>
	<div id="tag">
		<?php foreach($user['tags'] as $value) { ?>
		<p>
		<?php echo "#".$value['tag_name'] ?>
		</p>
		<?php } ?>
	</div>

</fieldset>
<script>
window.addEventListener('load',initMap);

function initMap() {
	map = new L.map('map');

	var user_location = { "lat" : <?php echo $user['latitude'];?>, "lon" : <?php echo $user['longitude'];?> };
	var marker = L.marker([user_location.lat, user_location.lon]).addTo(map);
	marker.bindPopup("<b>Your location</b><br>").openPopup();

	map.setView([user_location.lat, user_location.lon], 13);

	var osm = new L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
	attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a>',
		minZoom: 2,
		maxZoom: 18
	}).addTo(map);
}
</script>
