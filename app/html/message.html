<section id="message">

	<aside id="conv_list">
<?php
$user = $this->module_loader->session->controller->user_loggued();
foreach($this->data['all_conv'] as $conv) {
	$seen = "";
	if ($conv['id_user_from'] !== $user['id'])
		$seen = ($conv["seen"]) ? "seen" : "unseen";
?>
	<a href="<?php echo SITE_ROOT?>message/conversation/<?php echo $conv["id"]; ?>">
		<div id="<?php echo $conv["id"]; ?>" class="conversation <?php echo $seen; ?>">
<!--
				<?php echo $conv["id"]; ?>
				<?php echo $conv["id_user"]; ?>
				-->
				<img id="profil_pic" src="<?php echo MEDIA_PATH . $conv["id_media"] . ".png"; ?>">
				<p class="username">
					<?php echo ucfirst($conv["username"]); ?>
					<span class="date">
						<?php echo $conv["datetime"]; ?>
					</span>
				</p>
				<p class="last_message">
<?php
if ($conv['id_user_from'] === $user['id'])
	echo "You : ";
?>
					<?php echo $conv["last_msg"]; ?>
				</p>
			</div>
		</a>
<?php } ?>
	</aside>

	<section id="conv_content">
<?php
	if (!empty($this->data['id_conv']))
		$this->load_html('conversation');
?>
	</section>

	<aside id="recap_user">
	</aside>
<script>
/*
		worker2 = new SharedWorker("/matcha/app/assets/js/socket_worker.js");
		worker2.port.start();

		worker2.port.postMessage("TOTO");
 */
</script>
</section>
